<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sri YogaBala Snacks Corner</title>
    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#0f172a">
    <style>
        * {margin:0;padding:0;box-sizing:border-box;}
        body {font-family:Arial,sans-serif;background:#f4f4f4;padding:10px;}
        .container {max-width:1200px;margin:0 auto;}
        h1,h2 {text-align:center;color:#333;margin:20px 0;}
        .mode-toggle {background:white;padding:20px;border-radius:15px;margin:20px 0;text-align:center;box-shadow:0 4px 15px rgba(0,0,0,0.1);}
        .mode-buttons {display:flex;gap:15px;justify-content:center;flex-wrap:wrap;}
        .mode-btn {padding:12px 25px;border:none;border-radius:25px;cursor:pointer;font-size:16px;font-weight:bold;transition:all 0.3s;}
        .mode-btn.eat {background:#28a745;color:white;}
        .mode-btn.parcel {background:#ffc107;color:#333;}
        .mode-btn.active {box-shadow:0 4px 15px rgba(0,0,0,0.3);transform:scale(1.05);}
        .totals {display:flex;justify-content:space-around;margin:15px 0;background:#f8f9fa;padding:15px;border-radius:10px;}
        .total-box {text-align:center;}
        .total-label {font-size:14px;color:#666;}
        .total-value {font-size:28px;font-weight:bold;color:#28a745;margin:5px 0;}
        .menu-grid {display:grid;grid-template-columns:repeat(auto-fit,minmax(160px,1fr));gap:20px;margin:20px 0;}
        .menu-item {background:white;border-radius:15px;padding:15px;text-align:center;box-shadow:0 4px 15px rgba(0,0,0,0.1);cursor:pointer;transition:all 0.3s;position:relative;}
        .menu-item:hover {transform:translateY(-5px);}
        .menu-item img {width:100%;height:130px;object-fit:cover;border-radius:10px;}
        .item-name {font-weight:bold;margin:10px 0;font-size:16px;}
        .prices {display:flex;justify-content:space-between;font-size:14px;}
        .eat-price {color:#28a745;}
        .parcel-price {color:#ffc107;}
        .controls {position:absolute;top:10px;left:10px;right:10px;opacity:0;transition:all 0.3s;}
        .menu-item.active .controls {opacity:1;}
        .qty-controls {display:flex;justify-content:space-between;align-items:center;background:rgba(0,0,0,0.9);color:white;padding:15px;border-radius:10px;}
        .qty-btn {background:#007bff;color:white;border:none;width:50px;height:50px;border-radius:50%;font-size:24px;cursor:pointer;margin:0 5px;}
        .qty-btn:hover {background:#0056b3;}
        .qty-count {font-size:28px;font-weight:bold;background:white;color:black;padding:10px 20px;border-radius:10px;}
        #log-sale {background:#28a745;color:white;border:none;padding:18px 40px;font-size:20px;border-radius:30px;cursor:pointer;margin:20px auto;display:block;}
        #log-sale:hover {background:#218838;}
        .admin {background:white;padding:25px;border-radius:15px;margin:20px 0;box-shadow:0 4px 15px rgba(0,0,0,0.1);}
        .admin-form {display:flex;flex-wrap:wrap;gap:15px;align-items:end;}
        input {padding:12px;border:1px solid #ddd;border-radius:8px;flex:1;min-width:150px;}
        .admin-btn {background:#ffc107;color:#333;border:none;padding:12px 25px;border-radius:8px;cursor:pointer;font-weight:bold;}
        .admin-btn:hover {background:#e0a800;}
        .menu-list {margin-top:20px;}
        .menu-list-row {display:flex;justify-content:space-between;align-items:center;padding:12px;background:#f8f9fa;border-radius:8px;margin:5px 0;gap:10px;}
        .menu-list-info {flex:1;}
        .menu-list-actions {display:flex;gap:10px;}
        .delete-btn,.edit-btn {border:none;padding:8px 15px;border-radius:5px;cursor:pointer;font-size:13px;}
        .delete-btn {background:#dc3545;color:white;}
        .edit-btn {background:#17a2b8;color:white;}
        .reports {background:white;padding:25px;border-radius:15px;margin:20px 0;box-shadow:0 4px 15px rgba(0,0,0,0.1);}
        .tabs {display:flex;gap:10px;margin-bottom:20px;justify-content:center;flex-wrap:wrap;}
        .tab {padding:12px 20px;border:none;background:#ddd;cursor:pointer;border-radius:8px;font-weight:bold;}
        .tab.active {background:#007bff;color:white;}
        table {width:100%;border-collapse:collapse;margin-top:15px;}
        th,td {padding:12px;text-align:left;border-bottom:1px solid #eee;}
        th {background:#f8f9fa;font-weight:bold;}
        .order-row {background:#e8f5e8;}
        .total-row {background:#d4edda;font-weight:bold;}
        .small-btn {padding:5px 10px;font-size:12px;border-radius:4px;border:none;cursor:pointer;}
        .small-btn.del-sale {background:#dc3545;color:white;}
        #export {background:#17a2b8;color:white;border:none;padding:12px 25px;border-radius:8px;cursor:pointer;margin-top:15px;}
        #reset-app {background:#dc3545;color:white;border:none;padding:12px 25px;border-radius:8px;cursor:pointer;margin-top:15px;margin-left:10px;}
        @media (max-width:768px) {.admin-form {flex-direction:column;}.tabs {flex-direction:column;align-items:center;}.totals {flex-direction:column;gap:10px;}}
    </style>
</head>
<body>
    <div class="container">
        <h1>üçï Sri YogaBala Snacks Corner</h1>

        <!-- Mode & current bill totals -->
        <div class="mode-toggle">
            <div class="mode-buttons">
                <button class="mode-btn eat active" data-mode="eat">üçΩÔ∏è Eat</button>
                <button class="mode-btn parcel" data-mode="parcel">üì¶ Parcel</button>
            </div>
            <div>Select Eat OR Parcel for each item (mixed totals auto-calculate)</div>
            <div class="totals">
                <div class="total-box">
                    <div class="total-label">Eat Total</div>
                    <div class="total-value" id="eat-total">‚Çπ0</div>
                </div>
                <div class="total-box">
                    <div class="total-label">Parcel Total</div>
                    <div class="total-value" id="parcel-total">‚Çπ0</div>
                </div>
                <div class="total-box">
                    <div class="total-label">Grand Total</div>
                    <div class="total-value" id="grand-total">‚Çπ0</div>
                </div>
            </div>
        </div>

        <!-- Menu items -->
        <div id="menu-grid" class="menu-grid"></div>

        <!-- Log sale -->
        <button id="log-sale">‚úÖ Log Mixed Sale</button>
        <div style="text-align:center;font-size:18px;margin:10px;">
            <span id="date"></span> | <span id="time"></span>
        </div>

        <!-- Admin: Add/Update items -->
        <div class="admin">
            <h2>üîß Add / Update Menu Item</h2>
            <div class="admin-form">
                <input type="file" id="image" accept="image/*">
                <input type="text" id="name" placeholder="Item Name">
                <input type="number" id="eat-price" placeholder="Eat Price ‚Çπ" step="0.01">
                <input type="number" id="parcel-price" placeholder="Parcel Price ‚Çπ" step="0.01">
                <button class="admin-btn" id="save-btn" onclick="saveItem()">Add Item</button>
            </div>
            <small id="edit-hint" style="color:#666;display:block;margin-top:5px;">
                Tip: Click "Edit" on a row below to modify that item.
            </small>
            <div id="menu-list" class="menu-list"></div>
        </div>

        <!-- Reports -->
        <div class="reports">
            <h2>üìä Sales Report</h2>
            <div class="tabs">
                <button class="tab active" onclick="showReport(event,'daily')">Daily Orders</button>
                <button class="tab" onclick="showReport(event,'weekly')">Weekly Total</button>
                <button class="tab" onclick="showReport(event,'monthly')">Monthly Total</button>
                <button class="tab" onclick="showReport(event,'yearly')">Yearly Total</button>
            </div>
            <table id="report-table">
                <thead>
                    <tr>
                        <th>Date / Period</th>
                        <th>Order # / Info</th>
                        <th>Time / Orders</th>
                        <th>Eat ‚Çπ</th>
                        <th>Parcel ‚Çπ</th>
                        <th>Total ‚Çπ</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
            <button id="export" onclick="exportCSV()">üì• Export CSV</button>
            <button id="reset-app">üîÅ Reset All Data</button>
        </div>
    </div>

    <script>
        // Initial sample menu
        let menu = JSON.parse(localStorage.getItem('menu')) || [
            {id:1,name:'Samosa',eatPrice:3,parcelPrice:3,img:'https://via.placeholder.com/150x130/FF6B6B/FFFFFF?text=Samosa'},
            {id:2,name:'Vada',eatPrice:25,parcelPrice:30,img:'https://via.placeholder.com/150x130/4ECDC4/FFFFFF?text=Vada'},
            {id:3,name:'Bonda',eatPrice:20,parcelPrice:25,img:'https://via.placeholder.com/150x130/45B7D1/FFFFFF?text=Bonda'}
        ];

        let eatOrder = {};
        let parcelOrder = {};
        let sales = JSON.parse(localStorage.getItem('sales')) || [];
        let orderCounter = sales.length + 1;
        let currentMode = 'eat';
        let editingId = null;
        const RESET_PASSWORD = 'owner123'; // change as needed

        function saveStorage() {
            localStorage.setItem('menu', JSON.stringify(menu));
            localStorage.setItem('sales', JSON.stringify(sales));
        }

        // Render menu grid
        function renderMenu() {
            const grid = document.getElementById('menu-grid');
            grid.innerHTML = menu.map(item => `
                <div class="menu-item" data-id="${item.id}">
                    <img src="${item.img}" alt="${item.name}">
                    <div class="item-name">${item.name}</div>
                    <div class="prices">
                        <span class="eat-price">Eat: ‚Çπ${item.eatPrice}</span>
                        <span class="parcel-price">Parcel: ‚Çπ${item.parcelPrice}</span>
                    </div>
                    <div class="controls" data-id="${item.id}">
                        <div class="qty-controls">
                            <button class="qty-btn" data-id="${item.id}" data-action="-">-</button>
                            <div class="qty-count" data-id="${item.id}">0</div>
                            <button class="qty-btn" data-id="${item.id}" data-action="+">+</button>
                        </div>
                    </div>
                </div>
            `).join('');

            document.querySelectorAll('.menu-item').forEach(item => {
                item.addEventListener('click', function() {
                    this.classList.toggle('active');
                    const id = this.dataset.id;
                    const count = currentMode === 'eat' ? (eatOrder[id] || 0) : (parcelOrder[id] || 0);
                    document.querySelector(`.qty-count[data-id="${id}"]`).textContent = count;
                });
            });

            document.querySelectorAll('.qty-btn').forEach(btn => {
                btn.addEventListener('click', function(e) {
                    e.stopPropagation();
                    const id = this.dataset.id;
                    const action = this.dataset.action;
                    if (currentMode === 'eat') {
                        eatOrder[id] = (eatOrder[id] || 0) + (action === '+' ? 1 : -1);
                        if (eatOrder[id] < 0) eatOrder[id] = 0;
                        document.querySelector(`.qty-count[data-id="${id}"]`).textContent = eatOrder[id];
                    } else {
                        parcelOrder[id] = (parcelOrder[id] || 0) + (action === '+' ? 1 : -1);
                        if (parcelOrder[id] < 0) parcelOrder[id] = 0;
                        document.querySelector(`.qty-count[data-id="${id}"]`).textContent = parcelOrder[id];
                    }
                    updateTotals();
                });
            });
        }

        function updateTotals() {
            let eatTotal = 0, parcelTotal = 0;
            Object.entries(eatOrder).forEach(([id, qty]) => {
                const item = menu.find(i => i.id == id);
                if (item) eatTotal += item.eatPrice * qty;
            });
            Object.entries(parcelOrder).forEach(([id, qty]) => {
                const item = menu.find(i => i.id == id);
                if (item) parcelTotal += item.parcelPrice * qty;
            });
            document.getElementById('eat-total').textContent = `‚Çπ${eatTotal.toFixed(2)}`;
            document.getElementById('parcel-total').textContent = `‚Çπ${parcelTotal.toFixed(2)}`;
            document.getElementById('grand-total').textContent = `‚Çπ${(eatTotal + parcelTotal).toFixed(2)}`;
        }

        function logSale() {
            const eatTotal = Number(document.getElementById('eat-total').textContent.slice(1)) || 0;
            const parcelTotal = Number(document.getElementById('parcel-total').textContent.slice(1)) || 0;
            const grandTotal = eatTotal + parcelTotal;
            if (grandTotal <= 0) return;

            const now = new Date();
            const sale = {
                id: orderCounter++,
                date: now.toISOString().split('T')[0],
                time: now.toLocaleTimeString(),
                eatTotal: eatTotal,
                parcelTotal: parcelTotal,
                grandTotal: grandTotal,
                eatItems: Object.entries(eatOrder).filter(([_, q]) => q > 0),
                parcelItems: Object.entries(parcelOrder).filter(([_, q]) => q > 0)
            };
            sales.unshift(sale);
            saveStorage();
            alert(`‚úÖ Order #${sale.id}\nEat: ‚Çπ${eatTotal.toFixed(2)} + Parcel: ‚Çπ${parcelTotal.toFixed(2)} = ‚Çπ${grandTotal.toFixed(2)}`);

            eatOrder = {};
            parcelOrder = {};
            updateTotals();
            renderMenu();
            showReport(null,'daily');
        }

        // ADD / UPDATE MENU ITEMS
        function saveItem() {
            const file = document.getElementById('image').files[0];
            const name = document.getElementById('name').value.trim();
            const eatPrice = Number(document.getElementById('eat-price').value);
            const parcelPrice = Number(document.getElementById('parcel-price').value);

            if (!name || isNaN(eatPrice)) {
                alert('Name and Eat Price are required');
                return;
            }

            if (editingId === null) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const id = menu.length ? Math.max(...menu.map(i => i.id)) + 1 : 1;
                    menu.push({
                        id,
                        name,
                        eatPrice,
                        parcelPrice: isNaN(parcelPrice) ? 0 : parcelPrice,
                        img: file ? e.target.result : `https://via.placeholder.com/150x130/FF6B6B/FFFFFF?text=${encodeURIComponent(name)}`
                    });
                    afterSaveItem();
                };
                if (file) reader.readAsDataURL(file);
                else {
                    const id = menu.length ? Math.max(...menu.map(i => i.id)) + 1 : 1;
                    menu.push({
                        id,
                        name,
                        eatPrice,
                        parcelPrice: isNaN(parcelPrice) ? 0 : parcelPrice,
                        img: `https://via.placeholder.com/150x130/FF6B6B/FFFFFF?text=${encodeURIComponent(name)}`
                    });
                    afterSaveItem();
                }
            } else {
                const index = menu.findIndex(i => i.id === editingId);
                if (index === -1) { alert('Item not found'); return; }

                const updateFields = () => {
                    menu[index].name = name;
                    menu[index].eatPrice = eatPrice;
                    menu[index].parcelPrice = isNaN(parcelPrice) ? 0 : parcelPrice;
                };

                if (file) {
                    const reader2 = new FileReader();
                    reader2.onload = function(e) {
                        updateFields();
                        menu[index].img = e.target.result;
                        afterUpdateItem();
                    };
                    reader2.readAsDataURL(file);
                } else {
                    updateFields();
                    afterUpdateItem();
                }
            }
        }

        function afterSaveItem() {
            saveStorage();
            renderMenu();
            renderList();
            clearForm();
        }

        function afterUpdateItem() {
            saveStorage();
            renderMenu();
            renderList();
            clearForm();
            editingId = null;
            document.getElementById('save-btn').textContent = 'Add Item';
            document.getElementById('edit-hint').textContent = 'Tip: Click "Edit" on a row below to modify that item.';
        }

        function clearForm() {
            document.getElementById('image').value = '';
            document.getElementById('name').value = '';
            document.getElementById('eat-price').value = '';
            document.getElementById('parcel-price').value = '';
        }

        function renderList() {
            const list = document.getElementById('menu-list');
            list.innerHTML = menu.map(item => `
                <div class="menu-list-row">
                    <div class="menu-list-info">
                        <strong>${item.name}</strong> | Eat: ‚Çπ${item.eatPrice} | Parcel: ‚Çπ${item.parcelPrice}
                    </div>
                    <div class="menu-list-actions">
                        <button class="edit-btn" onclick="startEdit(${item.id})">Edit</button>
                        <button class="delete-btn" onclick="deleteItem(${item.id})">Delete</button>
                    </div>
                </div>
            `).join('');
        }

        function startEdit(id) {
            const item = menu.find(i => i.id === id);
            if (!item) return;
            editingId = id;
            document.getElementById('name').value = item.name;
            document.getElementById('eat-price').value = item.eatPrice;
            document.getElementById('parcel-price').value = item.parcelPrice;
            document.getElementById('image').value = '';
            document.getElementById('save-btn').textContent = 'Update Item';
            document.getElementById('edit-hint').textContent =
                `Editing item #${id} (${item.name}). Change fields and click "Update Item".`;
        }

        function deleteItem(id) {
            if (!confirm('Delete this menu item?')) return;
            menu = menu.filter(i => i.id !== id);
            saveStorage();
            renderMenu();
            renderList();
        }

        // === REPORTING HELPERS ===
        const MONTH_NAMES = [
            "January","February","March","April","May","June",
            "July","August","September","October","November","December"
        ];

        function getWeekOfMonth(date) {
            const firstDay = new Date(date.getFullYear(), date.getMonth(), 1);
            const dayOfWeek = firstDay.getDay();
            const adjustedDate = date.getDate() + dayOfWeek;
            return Math.ceil(adjustedDate / 7);
        }

        function getSales(period) {
            const now = new Date();
            return sales.filter(sale => {
                const saleDate = new Date(sale.date);
                switch(period) {
                    case 'daily':   return sale.date === now.toISOString().split('T')[0];
                    case 'weekly':  return saleDate >= new Date(now.getTime() - 7*24*60*60*1000);
                    case 'monthly': return true; // we regroup by month
                    case 'yearly':  return true; // regroup by year
                    default:        return true;
                }
            });
        }

        // main report renderer
        function showReport(ev, period) {
            if (ev) {
                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                ev.target.classList.add('active');
            }
            const periodSales = getSales(period);
            let html = '';

            if (period === 'daily') {
                periodSales.forEach(sale => {
                    html += `
                        <tr class="order-row">
                            <td>${sale.date}</td>
                            <td>#${sale.id}</td>
                            <td>${sale.time}</td>
                            <td>‚Çπ${(Number(sale.eatTotal)||0).toFixed(0)}</td>
                            <td>‚Çπ${(Number(sale.parcelTotal)||0).toFixed(0)}</td>
                            <td>
                                ‚Çπ${(Number(sale.grandTotal)||0).toFixed(0)}
                                <button class="small-btn del-sale" onclick="deleteSale(${sale.id})">Delete</button>
                            </td>
                        </tr>
                    `;
                });
                const dailyEat = periodSales.reduce((s,x)=>s+(Number(x.eatTotal)||0),0);
                const dailyParcel = periodSales.reduce((s,x)=>s+(Number(x.parcelTotal)||0),0);
                const dailyGrand = periodSales.reduce((s,x)=>s+(Number(x.grandTotal)||0),0);
                html += `
                    <tr class="total-row">
                        <td><strong>DAILY TOTAL</strong></td>
                        <td colspan="2">${periodSales.length} orders</td>
                        <td><strong>‚Çπ${dailyEat.toFixed(0)}</strong></td>
                        <td><strong>‚Çπ${dailyParcel.toFixed(0)}</strong></td>
                        <td><strong>‚Çπ${dailyGrand.toFixed(0)}</strong></td>
                    </tr>
                `;
            }
            else if (period === 'weekly') {
                const byWeek = {};
                periodSales.forEach(sale => {
                    const d = new Date(sale.date);
                    const label = 'Week ' + getWeekOfMonth(d);
                    if (!byWeek[label]) byWeek[label] = {eat:0,parcel:0,total:0,count:0};
                    byWeek[label].eat    += (Number(sale.eatTotal)||0);
                    byWeek[label].parcel += (Number(sale.parcelTotal)||0);
                    byWeek[label].total  += (Number(sale.grandTotal)||0);
                    byWeek[label].count++;
                });
                Object.entries(byWeek).sort().forEach(([label,data]) => {
                    html += `
                        <tr class="total-row">
                            <td><strong>${label}</strong></td>
                            <td colspan="2">${data.count} orders</td>
                            <td><strong>‚Çπ${data.eat.toFixed(0)}</strong></td>
                            <td><strong>‚Çπ${data.parcel.toFixed(0)}</strong></td>
                            <td><strong>‚Çπ${data.total.toFixed(0)}</strong></td>
                        </tr>
                    `;
                });
            }
            else if (period === 'monthly') {
                const byMonth = {};
                periodSales.forEach(sale => {
                    const d = new Date(sale.date);
                    const label = `${MONTH_NAMES[d.getMonth()]} ${d.getFullYear()}`;
                    if (!byMonth[label]) byMonth[label] = {eat:0,parcel:0,total:0,count:0};
                    byMonth[label].eat    += (Number(sale.eatTotal)||0);
                    byMonth[label].parcel += (Number(sale.parcelTotal)||0);
                    byMonth[label].total  += (Number(sale.grandTotal)||0);
                    byMonth[label].count++;
                });
                Object.entries(byMonth).forEach(([label,data]) => {
                    html += `
                        <tr class="total-row">
                            <td><strong>${label}</strong></td>
                            <td colspan="2">${data.count} orders</td>
                            <td><strong>‚Çπ${data.eat.toFixed(0)}</strong></td>
                            <td><strong>‚Çπ${data.parcel.toFixed(0)}</strong></td>
                            <td><strong>‚Çπ${data.total.toFixed(0)}</strong></td>
                        </tr>
                    `;
                });
            }
            else if (period === 'yearly') {
                const byYear = {};
                periodSales.forEach(sale => {
                    const d = new Date(sale.date);
                    const label = String(d.getFullYear());
                    if (!byYear[label]) byYear[label] = {eat:0,parcel:0,total:0,count:0};
                    byYear[label].eat    += (Number(sale.eatTotal)||0);
                    byYear[label].parcel += (Number(sale.parcelTotal)||0);
                    byYear[label].total  += (Number(sale.grandTotal)||0);
                    byYear[label].count++;
                });
                Object.entries(byYear).forEach(([label,data]) => {
                    html += `
                        <tr class="total-row">
                            <td><strong>${label}</strong></td>
                            <td colspan="2">${data.count} orders</td>
                            <td><strong>‚Çπ${data.eat.toFixed(0)}</strong></td>
                            <td><strong>‚Çπ${data.parcel.toFixed(0)}</strong></td>
                            <td><strong>‚Çπ${data.total.toFixed(0)}</strong></td>
                        </tr>
                    `;
                });
            }

            document.querySelector('#report-table tbody').innerHTML =
                html || '<tr><td colspan="6" style="text-align:center;padding:30px;">No sales yet</td></tr>';
        }

        // delete one sale (bill) from tally, recalc totals
        function deleteSale(id) {
            if (!confirm('Delete this bill from tally?')) return;
            sales = sales.filter(s => s.id !== id);
            saveStorage();
            showReport(null,'daily');
        }

        function exportCSV() {
            const activeTab = document.querySelector('.tab.active');
            const text = activeTab ? activeTab.textContent.toLowerCase() : 'daily orders';
            const period = text.includes('daily') ? 'daily'
                         : text.includes('weekly') ? 'weekly'
                         : text.includes('monthly') ? 'monthly'
                         : 'yearly';
            const data = getSales(period);
            const csv = ['Date,Order#,Time,Eat,Parcel,Total\n'] + data.map(s =>
                `${s.date},${s.id},"${s.time}",${Number(s.eatTotal)||0},${Number(s.parcelTotal)||0},${Number(s.grandTotal)||0}`
            ).join('\n');
            const blob = new Blob([csv], {type:'text/csv'});
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `snack-sales-${period}-${new Date().toISOString().split('T')[0]}.csv`;
            a.click();
        }

        // Reset with password
        document.getElementById('reset-app').onclick = function () {
            const sure = confirm('Are you sure you want to reset ALL data?');
            if (!sure) return;
            const pwd = prompt('Enter reset password:');
            if (pwd !== RESET_PASSWORD) {
                alert('Wrong password. Reset cancelled.');
                return;
            }
            localStorage.clear();
            menu = [
                {id:1,name:'Samosa',eatPrice:3,parcelPrice:3,img:'https://via.placeholder.com/150x130/FF6B6B/FFFFFF?text=Samosa'},
                {id:2,name:'Vada',eatPrice:25,parcelPrice:30,img:'https://via.placeholder.com/150x130/4ECDC4/FFFFFF?text=Vada'},
                {id:3,name:'Bonda',eatPrice:20,parcelPrice:25,img:'https://via.placeholder.com/150x130/45B7D1/FFFFFF?text=Bonda'}
            ];
            eatOrder = {};
            parcelOrder = {};
            sales = [];
            orderCounter = 1;
            updateTotals();
            renderMenu();
            renderList();
            showReport(null,'daily');
            alert('All data reset successfully.');
        };

        // INIT
        document.querySelectorAll('.mode-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('.mode-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                currentMode = this.dataset.mode;
            });
        });
        document.getElementById('log-sale').onclick = logSale;

        function clock() {
            const now = new Date();
            document.getElementById('date').textContent = now.toLocaleDateString('en-IN');
            document.getElementById('time').textContent = now.toLocaleTimeString('en-IN');
        }
        clock();
        setInterval(clock, 1000);

        renderMenu();
        renderList();
        updateTotals();
        showReport(null,'daily');
    // Register service worker (for installable app)
if ("serviceWorker" in navigator) {
  navigator.serviceWorker.register("sw.js")
    .then(() => console.log("Service Worker Registered"))
    .catch(err => console.log("SW failed", err));
}
    </script>
</body>
</html>
